# üìã –û—Ç—á–µ—Ç –æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –ø—Ä–æ–µ–∫—Ç–∞ Budget & Habits

**–î–∞—Ç–∞:** 27 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## üéØ –¶–µ–ª—å

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∏ –≤—ã–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–¥ –≤ –æ–±—â–∏–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞.

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. ‚ú® –°–æ–∑–¥–∞–Ω –ø–∞–∫–µ—Ç `@budget-habits/composables`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `packages/composables/`

–í–∫–ª—é—á–∞–µ—Ç:

- ‚úÖ `useDebounce` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–∑–∞–±–ª –¥–ª—è –¥–µ–±–∞—É–Ω—Å–∞ –∑–Ω–∞—á–µ–Ω–∏–π
- ‚úÖ `useSSE` - –∫–æ–º–ø–æ–∑–∞–±–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Server-Sent Events
- ‚úÖ –ü–æ–ª–Ω–∞—è TypeScript —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- ‚úÖ README —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
import { useDebounce, useSSE } from '@budget-habits/composables';
```

### 2. üõ†Ô∏è –°–æ–∑–¥–∞–Ω –ø–∞–∫–µ—Ç `@budget-habits/server-utils`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `packages/server-utils/`

–í–∫–ª—é—á–∞–µ—Ç:

- ‚úÖ `RateLimiter` - –∫–ª–∞—Å—Å –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ `insightRateLimiter` - –≥–æ—Ç–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –¥–ª—è insights API
- ‚úÖ `logInsight` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∞—É–¥–∏—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è insights
- ‚úÖ `getInsightStats` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ README —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
import { assertRateLimit, logInsight } from '@budget-habits/server-utils';
```

### 3. üì¶ –†–∞—Å—à–∏—Ä–µ–Ω –ø–∞–∫–µ—Ç `@budget-habits/schemas`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã `Message` –∏ `Chat`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã zod-—Å—Ö–µ–º—ã `messageSchema` –∏ `chatSchema`
- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã —Ç–∏–ø—ã –º–µ–∂–¥—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏

### 4. üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ SSE —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**apps/assistant/server/api/insights/**

- ‚úÖ `explain-trend.post.ts` - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `withSSE` –∏–∑ –ø–∞–∫–µ—Ç–∞
- ‚úÖ `report.post.ts` - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `withSSE` –∏–∑ –ø–∞–∫–µ—Ç–∞
- ‚úÖ –£–¥–∞–ª–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è —Ä—É—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è SSE

### 5. üîÑ –û–±–Ω–æ–≤–ª–µ–Ω—ã imports –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**apps/web:**

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `package.json` - –¥–æ–±–∞–≤–ª–µ–Ω—ã `@budget-habits/composables` –∏ `@budget-habits/server-utils`
- ‚úÖ `server/api/insights/autotag.post.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç
- ‚úÖ `server/api/insights/explain-trend.post.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç
- ‚úÖ `server/api/insights/report.post.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç
- ‚úÖ `components/transactions/TransactionFilters.vue` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `useDebounce` –∏–∑ –ø–∞–∫–µ—Ç–∞
- ‚úÖ `tests/unit/useSSE.spec.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç

**apps/assistant:**

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `package.json` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
- ‚úÖ `composables/useChat.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∏–ø—ã –∏–∑ `@budget-habits/schemas`
- ‚úÖ `server/api/chat.post.ts` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∏–ø—ã –∏–∑ `@budget-habits/schemas`
- ‚úÖ `components/Chat/MessageList.vue` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã
- ‚úÖ `pages/index.vue` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã

### 6. üóëÔ∏è –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ–∞–π–ª—ã

**–£–¥–∞–ª–µ–Ω–æ –∏–∑ apps/web:**

- ‚ùå `composables/useDebounce.ts` ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ –ø–∞–∫–µ—Ç
- ‚ùå `composables/useSSE.ts` ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ –ø–∞–∫–µ—Ç
- ‚ùå `server/utils/insight-audit.ts` ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ –ø–∞–∫–µ—Ç
- ‚ùå `server/api/insights/rate-limit.ts` ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ –ø–∞–∫–µ—Ç

**–£–¥–∞–ª–µ–Ω–æ –∏–∑ apps/assistant:**

- ‚ùå `components/Chat/types.ts` ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ schemas
- ‚ùå `types/Message.ts` ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ schemas
- ‚ùå `types/Chat.ts` ‚Üí –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ schemas
- ‚ùå `types/Model.ts` ‚Üí –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### 7. üìù –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –∫–æ—Ä–Ω–µ–≤–æ–π `README.md` —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω `packages/composables/README.md`
- ‚úÖ –°–æ–∑–¥–∞–Ω `packages/server-utils/README.md`

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º!

–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —Å–æ–±—Ä–∞—Ç—å.

### 1. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£–¥–∞–ª–∏—Ç–µ node_modules –∏ lock —Ñ–∞–π–ª—ã
rm -rf node_modules pnpm-lock.yaml
rm -rf apps/web/node_modules apps/assistant/node_modules
rm -rf packages/*/node_modules
```

### 2. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pnpm install
```

### 3. –°–±–æ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

```bash
# –°–æ–±–∏—Ä–∞–µ–º –Ω–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã
cd packages/composables
pnpm build
cd ../server-utils
pnpm build
cd ../..
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è turbo (–±—ã—Å—Ç—Ä–µ–µ):

```bash
pnpm -F @budget-habits/composables build
pnpm -F @budget-habits/server-utils build
```

### 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞

```bash
cd apps/web
pnpm prisma:generate
cd ../..
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤

```bash
pnpm typecheck
```

### 6. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

```bash
# –ò–∑ –∫–æ—Ä–Ω—è
pnpm dev

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã
./start-apps.sh       # Linux/Mac
./start-apps.ps1      # Windows PowerShell
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã: 2

- `@budget-habits/composables`
- `@budget-habits/server-utils`

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã: 1

- `@budget-habits/schemas`

### –£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã: 8

- 4 –∏–∑ apps/web
- 4 –∏–∑ apps/assistant

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã: ~15

- –°–µ—Ä–≤–µ—Ä–Ω—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –ö–æ–º–ø–æ–∑–∞–±–ª—ã
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –¢–µ—Å—Ç—ã
- package.json —Ñ–∞–π–ª—ã

## üéÅ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

1. **üì¶ –õ—É—á—à–∞—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å** - –æ–±—â–∏–π –∫–æ–¥ —Ç–µ–ø–µ—Ä—å –≤ –ø–∞–∫–µ—Ç–∞—Ö
2. **üîß –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
3. **‚ú® –ß–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
4. **üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –∫–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç –∏–º–µ–µ—Ç README
5. **üéØ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã
6. **‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–±–æ—Ä–∫–∞

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Rate Limiter** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis.

2. **Prisma –≤ server-utils** - —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã Prisma schema –±—ã–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ apps/web.

3. **useSSE –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ `window`).

4. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Å–ª–µ `pnpm install` –≤—Å–µ workspace –ø–∞–∫–µ—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω—ã.

## üêõ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. **Module not found –æ—à–∏–±–∫–∏:**

   ```bash
   pnpm install
   cd packages/composables && pnpm build
   cd ../server-utils && pnpm build
   ```

2. **TypeScript –æ—à–∏–±–∫–∏:**

   ```bash
   pnpm typecheck
   ```

3. **Prisma –æ—à–∏–±–∫–∏:**
   ```bash
   cd apps/web && pnpm prisma:generate
   ```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ README –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–∞–∫–µ—Ç—ã —Å–æ–±—Ä–∞–Ω—ã (`dist/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç)

---

**–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é! üéâ**
